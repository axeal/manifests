apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kube-prometheus-stack
  namespace: monitoring
spec:
  values:
    grafana:
      additionalDataSources:
      - name: Thanos
        type: prometheus
        access: proxy
        url: http://thanos-query.monitoring.svc.cluster.local:9090
        editable: false
        basicAuth: false
    prometheus:
      prometheusSpec:
        thanos:
          baseImage: raspbernetes/thanos
          version: v0.17.2
          objectStorageConfig:
            key: thanos.yaml
            name: thanos-object-storage
